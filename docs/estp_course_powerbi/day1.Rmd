---
title: "Introduction to business intelligence in public statistics (Power BI)"
subtitle: "Day 1"  
author: 
  - "Øyvind Bruer-Skarsbø (SSB)"
  - "Carl Franklin Corneil (SSB)"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    seal: false
    css: [xaringan-themer.css, custom.css]
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---
class: middle right
background-image: url(pictures/PowerBI_logo.png)
background-position: left

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE
)
```

```{r metathis, echo=FALSE}
library(metathis)
meta() %>%
  meta_name("github-repo" = "https://github.com/skars82/slides") %>% 
  meta_social(
    title = "Introduction to business intelligence in public statistics (Power BI)",
    description = paste(
      "3-day course in how a business intelligence tool lik Power BI can be used in public statistics. ",
      "Course held by European Statitical Training Programme (ESTP) in april of 2021."
    ),
    url = "https://skars82.github.io/slides/estp_course_powerbi/day1.html#1",
    image = "https://github.com/skars82/slides/tree/master/docs/estp_course_powerbi/pictures/twitter_slide.png",
    image_alt = paste(
      "Title slide of day 1 of ESTP-course in Power BI:", 
      "How can Power BI be utilized in public statistics.", 
      "Estp-course held in april of 2021."
    ),
    og_type = "website",
    og_author = "Øyvind Bruer-Skarsbø",
    twitter_card_type = "summary_large_image",
    twitter_creator = "@YSkarsb",
    twitter_site = "@YSkarsb"
  )
```

```{r, echo=FALSE}
dark_yellow <- "#EFBE43"
light_yellow <- "#FDF7E9"
gray <- "#333333"
blue <- "#4466B0"
```


```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_duo(
  # colors
  primary_color = light_yellow,
  secondary_color = dark_yellow,
  header_color = gray,
  text_color = gray,
  code_inline_color = colorspace::lighten(gray),
  text_bold_color = colorspace::lighten(gray),
  link_color = "#D6950F",
  title_slide_text_color = blue,
          # fonts
          header_font_google = google_font("Martel"),
          text_font_google = google_font("Lato"),
          code_font_google = google_font("Fira Mono"))
```

```{r xaringan-tile-view, echo=FALSE}
xaringanExtra::use_tile_view()
```

```{r share-again, echo=FALSE}
xaringanExtra::use_share_again()
```

```{r xaringan-logo, echo=FALSE}
xaringanExtra::use_logo(
  image_url = "pictures/ssb-logo-rgb300pxl.png", position=xaringanExtra::css_position(top="1em", right="1em")
)
```

```{r xaringan-animate-all, echo=FALSE}
xaringanExtra::use_animate_css()
```

```{r xaringan-scribble, echo=FALSE}
xaringanExtra::use_scribble()
```

.title[Introduction to business intelligence in public statistics (Power BI)]

.title[.posi2[Webinar hosted by European Statistical Training System (ESTP) and Statistics Norway (SSB)]]
<br>
.title[.posi[20.-22. april 2021]] 

???

- Welcome
<br>
<br>
- First ESTP-course
<br>
<br>
- a large group
<br>
<br>
- why the interest
<br>
<br>
- challenges with a webinar

---

## About us

.pull-left[


```{r, echo=FALSE, out.width="30%", fig.cap="Øyvind Bruer-Skarsbø"}
knitr::include_graphics("pictures/obr2.png")
```


```{r, echo=FALSE, out.width="30%", fig.cap="Carl Franklin Corneil"}
knitr::include_graphics("pictures/Carl_bg.png")
```


]

.pull-center[
.bio[
*Senior Advisor*  
*Division of Social Statistics*  
*Labour Market and Wage Statistics*  
*Statistics Norway*]
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

.bio2[
*Advisor*  
*Division of Social Statistics*  
*Labour Market and Wage Statistics*  
*Statistics Norway*]
]
---
class: inverse center middle right

## Aim of this course


.quote[
The aim of this course is to give the participants an understanding of how a business intelligence tool like Power BI can be usefull in the production of official statistics, and show how to build basic dashboards using Power BI Desktop.]


---

## About this course


- All resources available at the [course website](https://skars82.github.io/estp_course_pbi/)
<br>
<br>

--
- We assume that you have installed .animated.bounce.dib[[Power BI Desktop!](https://powerbi.microsoft.com/en-us/downloads/)]
<br>
<br>

--
- We are a big group (35 participants)
<br>
<br>

--
- Lets divide into 7 groups with 5 each for discussions


---
class: inverse center middle

```{r, echo=FALSE}
library(magrittr)
library(DT)
Group1 <- c("Klodiana Ducka", "Julia Maestro", "Dovilė Butkevičiūtė", "Antoine Tanguy", "Rui Gouveia")
Group2 <- c("Kelly Sabbe", "Rogelio Lopez", "Mike Bissener", "Siri Lozano-Handelsby", "Daniela Costa Ramos")
Group3 <- c("Deyan Slavov", "Mátyás Milkovics", "Marica Messina", "Svetlana Badina", "Matej Stare")
Group4 <- c("Maria Kjærsgård-Jensen", "Katalin Bányász", "Lucien May", "Henrik Burvang", "Helena Čermáková")
Group5 <- c("Marianne Vester", "Evelin Oláhné Gyurics", "Marie Waltzer", "Dominik Krężołek", "Kristína Csongárová")
Group6 <- c("Ines Martin", "Zsuzsanna Berendi", "Jeļena Voronova", "Tomasz Brzdak", "Lucia Šimeková")
Group7 <- c("Rogelio Pujol Rodriguez", "Sorcha OCallaghan", "lvijs Silins", "Bigniew Florianczyk", "Mert Kocausta")
x <- data.table::data.table(Group1, Group2, Group3, Group4, Group5, Group6, Group7)
datatable(x, 
          rownames = FALSE, 
          filter = "none",
          options=list(dom="t",ordering=F)) %>%
  formatStyle(columns=colnames(.), fontSize="50%")
```

--

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Yellowtail&display=swap" rel="stylesheet">

.handw[Discussions]

--

.handw2[Help eachother]

--

.handw3[1 group leader that can speaks for the group]

---
## What is Business intelligence (BI)? 

- Tools to ~~easily~~ extract and communicate insights from data
<br>
<br>

--
- Response to the growing amount of data in all organizations
<br>
<br>

--
- Make an organisation less dependent on its IT-departement
<br>
<br>

--
- An answer to the "webbrowser-takeover"
<br>
<br>

--
- A javascript-free life &#x1F60E;  


<img style="float: right;" alt="" src="https://media.giphy.com/media/5PhpuOph9pwoyuqHjd/giphy.gif" />
<div style="clear: right">
   ...text...
</div> 


---
class: top left
background-image: url(pictures/gartner_2020.png)
background-size: 80% 80%
background-position: bottom center

## Why Power BI?


---
class: inverse center middle

<div class="container">
<blockquote class="brooks">
I web, therefore I am <strike>spiderman</strike>
<br>
<footer>Yihui Xie, RStudio</footer>
</blockquote>
</div>

---

## Fundamentals of Power BI

- Microsoft product
<br>
<br>
- Desktop-version is free, and the rest costs
<br>
<br>
- Can handle most data sources...even big data!
<br>
<br>



---
class: inverse left 
background-image: url(pictures/pipeline.png)
background-position: center middle

## Basic PBI pipeline


  
---
class: inverse center middle

.animated.heartBeat.dib2[Breaktime!!]
---


## Main parts of Power BI

--

.pull-left[

### <span style="color: #EFBE43;">1. Report window</span>

- Visualizing
<br>
<br>
- Data model
<br>
<br>
- Publishing
]

--

.pull-right[

### <span style="color: #EFBE43;">2. Power Query</span>

- Extract/import data
<br>
<br>
- Transform data
<br>
<br>
- Load data

]

--
<br>
<br>
<br>
<span style="color: #EFBE43;font-size: 3em;"> Lets open Power BI Desktop!!</span>


---

## Task 1: Importing (more) data


- **Import** and **append** the the rest of the csv-files. Remember to do the same transformations as we did with with the first dataset!  

*Hint: There are many ways to do this, but remember the trick of duplicating queries in Power Query.
<br>
<br>
- After youre done importing data, check that data types and other things have not changed. 
<br>
<br>
- Load the data into the report-window. 
<br>
<br>
- Create a line chart with date on the x-axis and the number of people on the y-axis. 


---

## Building a data model










  







